# Custom Perp DEX - DLOB Server Configuration
# Copy to .env before running: cp .env.custom .env

# ─── RPC Configuration ───────────────────────────────────────────
ENDPOINT=https://api.devnet.solana.com
WS_ENDPOINT=wss://api.devnet.solana.com

# ─── Environment ─────────────────────────────────────────────────
ENV=devnet

# ─── Markets to Load ─────────────────────────────────────────────
# SOL-PERP (0), BTC-PERP (1), ETH-PERP (2)
PERP_MARKETS_TO_LOAD=0,1,2
# USDC spot (0)
SPOT_MARKETS_TO_LOAD=0

# ─── Server Configuration ───────────────────────────────────────
PORT=6969
METRICS_PORT=9464

# ─── Data Subscription ──────────────────────────────────────────
# Use polling for devnet (WebSocket + gRPC are for production)
USE_WEBSOCKET=false
USE_ORDER_SUBSCRIBER=true
USE_GRPC=false
ORDERBOOK_UPDATE_INTERVAL=1000

# ─── Redis ───────────────────────────────────────────────────────
ELASTICACHE_HOST=localhost
ELASTICACHE_PORT=6379
USE_REDIS=true
REDIS_CLIENT=DLOB
# LOCAL_CACHE=true + RUNNING_LOCAL=true disables TLS for local Redis
# cluster: false is set explicitly in src/index.ts to avoid cluster mode
LOCAL_CACHE=true
RUNNING_LOCAL=true

# ─── Polling Intervals ──────────────────────────────────────────
BULK_ACCOUNT_LOADER_POLLING_INTERVAL=10000
EVENT_SUBSCRIBER_POLLING_INTERVAL=10000

# ─── Monitoring ──────────────────────────────────────────────────
# TOB monitoring for stuck order detection
ENABLE_TOB_MONITORING=true
TOB_CHECK_INTERVAL=60000
TOB_STUCK_THRESHOLD=60000
TOB_MONITORING_ENABLED_PERP_MARKETS=0,1,2

# Disable GPA refresh for devnet (lower RPC load)
DISABLE_GPA_REFRESH=true

# Rate limiting
RATE_LIMIT_CALLS_PER_SECOND=30

# ─── Optional: Fill Quality Analytics (requires AWS Athena) ─────
ENABLE_FILL_QUALITY_ANALYTICS=false

# ─── Optional: Pyth Hermes (for /pythPull endpoint) ─────────────
# HERMES_ENDPOINT=https://hermes.pyth.network
